-- liquibase formatted sql

-- changeset alex2:1711220953216-1
CREATE TABLE cart (CartID INT AUTO_INCREMENT NOT NULL, UserID INT NULL, CONSTRAINT PK_CART PRIMARY KEY (CartID), UNIQUE (UserID));

-- changeset alex2:1711220953216-2
CREATE TABLE cartitems (CartID INT NULL, CartItemID INT AUTO_INCREMENT NOT NULL, ProductID INT NULL, Quantity INT NULL, CONSTRAINT PK_CARTITEMS PRIMARY KEY (CartItemID));

-- changeset alex2:1711220953216-3
CREATE TABLE categories (CategoryID INT AUTO_INCREMENT NOT NULL, Name VARCHAR(255) NULL, CONSTRAINT PK_CATEGORIES PRIMARY KEY (CategoryID));

-- changeset alex2:1711220953216-4
CREATE TABLE favorites (FavoriteID INT AUTO_INCREMENT NOT NULL, ProductID INT NULL, UserID INT NULL, CONSTRAINT PK_FAVORITES PRIMARY KEY (FavoriteID));

-- changeset alex2:1711220953216-5
CREATE TABLE orderitems (OrderID INT NULL, OrderItemID INT AUTO_INCREMENT NOT NULL, PriceAtPurchase DOUBLE NULL, ProductID INT NULL, Quantity INT NULL, CONSTRAINT PK_ORDERITEMS PRIMARY KEY (OrderItemID));

-- changeset alex2:1711220953216-6
CREATE TABLE orders (OrderID INT AUTO_INCREMENT NOT NULL, UserID INT NULL, CreatedAt datetime NULL, UpdatedAt datetime NULL, ContactPhone VARCHAR(255) NULL, DeliveryAddress VARCHAR(255) NULL, DeliveryMethod VARCHAR(255) NULL,
Status ENUM('CREATED', 'CANCEL', 'WAIT_PAYMENT', 'PAID', 'ON_THE_WAY', 'DELIVERED') NULL, CONSTRAINT PK_ORDERS PRIMARY KEY (OrderID));

-- changeset alex2:1711220953216-7
CREATE TABLE products (CategoryID INT NULL, DiscountPrice DOUBLE NULL, Price DOUBLE NULL, ProductID INT AUTO_INCREMENT NOT NULL, CreatedAt datetime NULL, UpdatedAt datetime NULL, `Description` VARCHAR(255) NULL, ImageURL VARCHAR(255) NULL, Name VARCHAR(255) NULL, CONSTRAINT PK_PRODUCTS PRIMARY KEY (ProductID));

-- changeset alex2:1711220953216-8
CREATE TABLE users (UserID INT AUTO_INCREMENT NOT NULL, Email VARCHAR(255) NULL, Name VARCHAR(255) NULL, PasswordHash VARCHAR(255) NULL, PhoneNumber VARCHAR(255) NULL, `Role` ENUM('CLIENT', 'ADMIN') NULL, CONSTRAINT PK_USERS PRIMARY KEY (UserID));

-- changeset alex2:1711220953216-9
CREATE INDEX FK2lvnbm7xw4328o6mrps8s2atl ON favorites(UserID);

-- changeset alex2:1711220953216-10
CREATE INDEX FK619wmc3r2h6jvafftu57fom0f ON orderitems(ProductID);

-- changeset alex2:1711220953216-11
CREATE INDEX FKajrm3nn51ygonfk36xkmqaoco ON cartitems(ProductID);

-- changeset alex2:1711220953216-12
CREATE INDEX FKflh4cjcr04aq0m5vswnx4ioal ON cartitems(CartID);

-- changeset alex2:1711220953216-13
CREATE INDEX FKianabk7ggi0e8g66gxvf2grt0 ON orderitems(OrderID);

-- changeset alex2:1711220953216-14
CREATE INDEX FKmfakbsnvioe57ejt5qa2h72k0 ON favorites(ProductID);

-- changeset alex2:1711220953216-15
CREATE INDEX FKph55bub15tpuk7emg6atv2yus ON orders(UserID);

-- changeset alex2:1711220953216-16
CREATE INDEX FKpuwdc4db4doatnavrifkfxgys ON products(CategoryID);

-- changeset alex2:1711220953216-17
ALTER TABLE favorites ADD CONSTRAINT FK2lvnbm7xw4328o6mrps8s2atl FOREIGN KEY (UserID) REFERENCES users (UserID) ON UPDATE RESTRICT ON DELETE RESTRICT;

-- changeset alex2:1711220953216-18
ALTER TABLE cart ADD CONSTRAINT FK3qehgvajrxcm7agspcmxnmjyc FOREIGN KEY (UserID) REFERENCES users (UserID) ON UPDATE RESTRICT ON DELETE RESTRICT;

-- changeset alex2:1711220953216-19
ALTER TABLE orderitems ADD CONSTRAINT FK619wmc3r2h6jvafftu57fom0f FOREIGN KEY (ProductID) REFERENCES products (ProductID) ON UPDATE RESTRICT ON DELETE RESTRICT;

-- changeset alex2:1711220953216-20
ALTER TABLE cartitems ADD CONSTRAINT FKajrm3nn51ygonfk36xkmqaoco FOREIGN KEY (ProductID) REFERENCES products (ProductID) ON UPDATE RESTRICT ON DELETE RESTRICT;

-- changeset alex2:1711220953216-21
ALTER TABLE cartitems ADD CONSTRAINT FKflh4cjcr04aq0m5vswnx4ioal FOREIGN KEY (CartID) REFERENCES cart (CartID) ON UPDATE RESTRICT ON DELETE RESTRICT;

-- changeset alex2:1711220953216-22
ALTER TABLE orderitems ADD CONSTRAINT FKianabk7ggi0e8g66gxvf2grt0 FOREIGN KEY (OrderID) REFERENCES orders (OrderID) ON UPDATE RESTRICT ON DELETE RESTRICT;

-- changeset alex2:1711220953216-23
ALTER TABLE favorites ADD CONSTRAINT FKmfakbsnvioe57ejt5qa2h72k0 FOREIGN KEY (ProductID) REFERENCES products (ProductID) ON UPDATE RESTRICT ON DELETE RESTRICT;

-- changeset alex2:1711220953216-24
ALTER TABLE orders ADD CONSTRAINT FKph55bub15tpuk7emg6atv2yus FOREIGN KEY (UserID) REFERENCES users (UserID) ON UPDATE RESTRICT ON DELETE RESTRICT;

-- changeset alex2:1711220953216-25
ALTER TABLE products ADD CONSTRAINT FKpuwdc4db4doatnavrifkfxgys FOREIGN KEY (CategoryID) REFERENCES categories (CategoryID) ON UPDATE RESTRICT ON DELETE RESTRICT;

